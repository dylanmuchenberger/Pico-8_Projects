pico-8 cartridge // http://www.pico-8.com
version 27
__lua__
-- menu (implement later)
function _init() menu_init() end

function menu_init()
 _draw=menu_draw
 _update=menu_update
end

function menu_update()
  if btn(5) then
    game_init()
  end
end

function menu_draw()
  cls()
  spr(3,46,40)
  spr(4,54,40)
  spr(5,62,40)
  spr(6,70,40)
  print('press ‚ùé to start', 32, 90, 7)
end
-->8
-- game
function game_init()
 _update=game_update
 _draw=game_draw
 
hold=true
p={}
  p.w=1.5
  p.h=20
  p.x=4
  p.y=64-(p.h/2)
  p.s=2
  p.score=0
e={}
  e.w=1.5
  e.h=20
  e.x=123
  e.y=64-(p.h/2)
  e.s=1.8
  e.score=0
b={}
  b.x=64
  b.y=64
  b.w=2
  b.h=2
  b.sx=-2
  b.sy=-2
end

function player()
  if btn(3) and p.y+p.h<102 then
    p.y+=p.s
  elseif btn(2) and p.y>22 then
    p.y-=p.s 
  end
end

function enemy()
  if b.y>e.y+e.w and e.y+e.h<102 then
    e.y+=e.s
  elseif b.y<e.y and e.y>22 then
    e.y-=e.s
  end
end

function ball()
  if b.x>133 then 
    b.x=64
    b.y=64
    p.score+=1
    p.h=20-p.score
    hold=true
    sfx(3)
  end
  if b.x<-5 then
    b.x=64
    b.y=64
    e.score+=1
    hold=true
    sfx(3)
  end
  if b.y+b.h>=102 or b.y<=23 then
    b.sy=~b.sy
    sfx(0)
  end
  if b.x<=p.x and b.x>=p.x-p.w and b.y>=p.y and b.y<=p.y+p.h or b.x>=e.x and b.x<=e.x+e.w and b.y>=e.y and b.y<=e.y+e.h then
    sfx(0)
    b.sx=~b.sx
    if b.sy>0 then
      b.sy=flr(rnd(3)+1)
    elseif b.sy<0 then
      b.sy=~flr(rnd(3)+1)
    end
  end

  if not hold then
    b.x+=b.sx
    b.y+=b.sy
  end
end

function winLoseCondition()
  if (p.score>4) then
    win_init(true)
  elseif (e.score>4) then
    win_init(false)
  end
end

function game_update()
  if btn(4) then
    hold=false
  end
  player()
  enemy()
  ball()
  winLoseCondition()
end

function game_draw()
 cls()
 map(0,0,0,0,32,32)
 rectfill(p.x,p.y,p.x+p.w,p.y+p.h,7)
 rectfill(e.x,e.y,e.x+e.w,e.y+e.h,7)
 rectfill(b.x,b.y,b.x+b.w,b.y+b.h,7)
 print(p.score..'-'..e.score,58,10,7)
 print(b.sy,10,10,7)

 if hold then
  print('press üÖæÔ∏è',50,50,7)
 end
end

-->8
-- win/lose
function win_init(state)
  _update=win_update
  _draw=win_draw
  win_state=state

  if (win_state) then
    music(0)
  else
    music(1)
  end
end

function win_update()
  if btn(4) then
    menu_init()
  end
end

function win_draw()
  cls()
  map(0,0,0,0,32,32)
  if (win_state) then
    print('you win!',50,50,7)
  else
    print('you Lose!',50,50,7)
  end

  print('press üÖæÔ∏è to restart', 30, 70, 7)
end

__gfx__
00000000777777770000000000077700000770000770007000077700000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000070070007007000770007000700070000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000070070070000700707007007000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000077700070000700707007007000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000070000070000700700707007007777000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000007777777700070000070000700700707007000007000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000070000007007000700077000700077000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000070000000770000700077000077707000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0202020202020202020202020202020200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
0003000031300302002f3002f2002f5002e5002e5002d5002d500105501955020550275001750035000255002550026500295002d500305003450035500315003250032500285000000000000000000000000000
001000001055011550135501555015550155500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000001555013550115501055010550105500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0003000020050200501f050200502205025050280202d010330103800000000310003300035000360003600037000370003700036000350003400034000000000000000000000000000000000000000000000000
__music__
04 01424344
04 02424344

