pico-8 cartridge // http://www.pico-8.com
version 27
__lua__

function set_player(x,y,w,h)
  local p={
    x=x,
    y=y,
    w=w,
    h=h,
    s=2,
    dx=0,
    dy=0,
    ds=1.5,
  }

  return p
end

function _init()
  p=set_player(10,111,7,7)
end


function move_player()
  p.s=2

  local oldpx=p.x
  local oldpy=p.y
  
  if btn(1) then
    p.dx=p.ds
  elseif btn(0) then
    p.dx=-p.ds
  else
    p.dx=0
  end

  if btn(2) then
    p.dy=-1.5
    p.s=3
  else
    p.dy=2
  end

  if map_collision(p.x+p.dx,p.y,p.w,p.h) then
    p.dx=0
  end
  if map_collision(p.x,p.y+p.dy,p.w,p.h) then
    p.dy=0
  end

  p.x+=p.dx
  p.y+=p.dy
end

function map_collision(x,y,w,h)
  for i=x,x+w,w do
    if fget(mget(i/8,y/8))==2 or fget(mget(i/8,(y+h)/8))==2 then
      return true
    end
  end

  return false
end

function _update()
  move_player()
end

function _draw()
  cls()
  map(0,0,0,0,16,16)
  spr(p.s,p.x,p.y)
end

__gfx__
00000000000dd0000000000000000000000000000000000044444444444444440000000000000000000000000000000000000000000000000000000000000000
0000000000dccd000000000000333b00000000000000000044444444444444440000000000000000000000000000000000000000000000000000000000000000
007007000dccccd00003b000003535b0000000000000000044444444444444440000000000000000000000000000000000000000000000000000000000000000
00077000dcdccdcd00333b00033333b0005004000000000044444444444444440000000000000000000000000000000000000000000000000000000000000000
000770000ddccdd0003535b0033333b0058458400000000044444444444444440000000000000000000000000000000000000000000000000000000000000000
0070070000dccd00033333b00033bb0055554444000000004444444bb44444440000000000000000000000000000000000000000000000000000000000000000
0000000000dccd00033333b00003b00055588444000000004444443bb34444440000000000000000000000000000000000000000000000000000000000000000
00000000000dd00033333bbb0000000005000040000000004444433333b444440000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000004444433b3b3444440000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000004444443b334444440000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000044444443344444440000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000044444444444444440000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000044444444444444440000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000044444444444444440000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000044444444444444440000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000044444444444444440000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000044444333b33344440000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000004444343b33b444440000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000444443b3334444440000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000044444433b33444440000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000004444433b334444440000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000444444333b3444440000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000044444b33b34344440000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000004444333b333444440000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000444444443b33b33b444444440000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000004444444433b33333444444440000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000044444444343434b3444444440000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000004444444443444443444444440000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000004444444444444444344444340000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000044444444444444443b4343430000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000444444444444444433333b330000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000004444444444444444b33b33b30000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000000000000000000000000000000000000000000000000020200000000000000000000000000020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0637373737373737373737373737370700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000000000000000000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000000000000000000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000000000000000000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000000000000000000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000000000000000000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000000000000000000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000000000000000000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000000000000000000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000000000000000000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000000000000000000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000000000000100000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000010000000000363636361700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600000000000036360000000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2600003636000035350000000000002700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1636363535363635353636363636361700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
